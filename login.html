<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CineMax â”‚ Iniciar SesiÃ³n</title>

  <!-- Bootstrap + Iconos -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

  <style>
    :root{
      --brand-dark:#212529;
      --shadow-lg:0 10px 30px rgba(0,0,0,.1);
    }

    body{background:#f8f9fa;}

    .btn-brand{
      background:var(--brand-dark);
      border-color:var(--brand-dark);
      color:#fff;
      transition:.2s;
    }
    .btn-brand:hover{background:#343a40;border-color:#343a40;color:#fff;}

    .login-container{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem 0;}
    .login-card{max-width:900px;width:100%;box-shadow:var(--shadow-lg);border-radius:15px;overflow:hidden;}
    .login-left{background:#563dff;color:#fff;display:flex;flex-direction:column;justify-content:center;padding:3rem 2rem;}
    .login-left h2{font-weight:700;}
    .login-form{padding:3rem;}

    .form-control{border-radius:10px;border:2px solid #e9ecef;padding:.75rem 1rem;transition:.3s;}
    .form-control:focus{border-color:var(--brand-dark);box-shadow:0 0 0 .2rem rgba(33,37,41,.25);}

    .role-badge{display:inline-block;padding:.25rem .75rem;border-radius:50px;font-size:.8rem;font-weight:500;margin:.25rem;cursor:pointer;border:2px solid transparent;transition:.3s;}
    .role-badge.cliente{background:#e3f2fd;color:#1976d2;}
    .role-badge.admin{background:#fff3e0;color:#f57c00;}
    .role-badge.selected{border-color:#fff;transform:scale(1.05);}

    @media (max-width: 768px){
      .login-form,.login-left{padding:2rem;}
      .login-card{margin:1rem;}
    }
  </style>
</head>

<body class="d-flex flex-column">

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow">
    <div class="container">
      <a class="navbar-brand fs-3" href="index.html">ðŸŽ¬ CineMax</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
          <li class="nav-item admin-only d-none"><a class="nav-link" href="admin.html">Panel Admin</a></li>
          <li class="nav-item"><a class="nav-link" href="comedia.html">Comedia</a></li>
          <li class="nav-item"><a class="nav-link" href="drama.html">Drama</a></li>
          <li class="nav-item"><a class="nav-link" href="terror.html">Terror</a></li>
          <li class="nav-item"><a class="nav-link" href="estrategia.html">Estrategia</a></li>
        </ul>

        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item"><a class="nav-link" href="registro.html" id="link-registro">Registro</a></li>
          <li class="nav-item"><a class="nav-link active" href="#">Iniciar SesiÃ³n</a></li>
          <li class="nav-item d-none" id="btn-profile"><a class="btn btn-outline-light btn-sm ms-2" href="perfil.html">Mi Perfil</a></li>
          <li class="nav-item"><button id="btn-logout" class="btn btn-outline-light btn-sm ms-2 d-none">Logout</button></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- ---------- LOGIN ---------- -->
  <main class="login-container flex-grow-1">
    <div class="login-card row g-0">

      <div class="col-lg-5 login-left">
        <h2 class="mb-3">ðŸŽ¬ Bienvenido a CineMax</h2>
        <p class="mb-4">Accede con tu cuenta para disfrutar de la mejor experiencia cinematogrÃ¡fica.</p>

        <h6 class="mb-2">Roles disponibles:</h6>
        <div>
          <span class="role-badge cliente">Cliente</span>
          <span class="role-badge admin">Administrador</span>
        </div>
      </div>

      <!-- Columna Derecha -->
      <div class="col-lg-7 login-form">
        <h3 class="mb-4 text-center">Iniciar SesiÃ³n</h3>

        <!-- Credenciales demo -->
        <div class="alert alert-light border-start border-4 mb-4">
          <small>
            <strong>Cliente:</strong> cliente@cinemax.com | Cliente123 <br>
            <strong>Admin:</strong> admin@cinemax.com | Admin123
          </small>
        </div>

        <form id="loginForm" novalidate>
          <div class="mb-3">
            <label for="email" class="form-label">Correo ElectrÃ³nico</label>
            <input type="email" id="email" class="form-control" placeholder="tu@email.com" required/>
            <div class="invalid-feedback">Por favor ingresa un correo vÃ¡lido.</div>
          </div>

          <div class="mb-3">
            <label for="password" class="form-label">ContraseÃ±a</label>
            <input type="password" id="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required/>
            <div class="invalid-feedback">La contraseÃ±a es requerida.</div>
          </div>

          <div class="mb-3 form-check">
            <input type="checkbox" id="recordar" class="form-check-input"/>
            <label class="form-check-label" for="recordar">Recordar mis datos</label>
          </div>

          <button type="submit" class="btn btn-brand w-100 py-2 mb-3">Iniciar SesiÃ³n</button>

          <div class="text-center">
            <p class="mb-2">Â¿No tienes cuenta? <a href="registro.html">RegÃ­strate aquÃ­</a></p>
            <a href="recuperar.html" class="small">Â¿Olvidaste tu contraseÃ±a?</a>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- ---------- FOOTER ---------- -->
  <footer class="bg-dark text-white text-center py-3 mt-auto">
    Â© 2024 CineMax. Todos los derechos reservados.
  </footer>

  <!-- ---------- SCRIPTS ---------- -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="javascript/script.js"></script>

  <script>
  const usuarios = {
    'cliente@cinemax.com': {
      password:'Cliente123',
      rol:'cliente',
      nombre:'Juan PÃ©rez',
      perfil:{telefono:'+56 9 1234 5678',fechaNacimiento:'1990-05-15'}
    },
    'admin@cinemax.com': {
      password:'Admin123',
      rol:'admin',
      nombre:'Haim Pizarro',
      perfil:{telefono:'+56 9 8765 4321',fechaNacimiento:'1985-12-10'}
    }
  };

  document.addEventListener('DOMContentLoaded', () => {
    const form      = document.getElementById('loginForm');
    const emailInp  = document.getElementById('email');
    const passInp   = document.getElementById('password');
    const recordar  = document.getElementById('recordar');

    document.querySelectorAll('.role-badge').forEach(badge=>{
      badge.addEventListener('click',()=>{
        if(badge.classList.contains('cliente')){
          emailInp.value='cliente@cinemax.com';passInp.value='Cliente123';
        }else{
          emailInp.value='admin@cinemax.com';passInp.value='Admin123';
        }
        document.querySelectorAll('.role-badge').forEach(b=>b.classList.remove('selected'));
        badge.classList.add('selected');
      });
    });

    /* ---------- Recordar usuario ---------- */
    const recuerdame = localStorage.getItem('recordarUsuario');
    if(recuerdame){emailInp.value=recuerdame;recordar.checked=true;}

    /* ---------- SesiÃ³n activa ---------- */
    const sesionActiva = sessionStorage.getItem('sesionCineMax');
    if(sesionActiva){
      const s = JSON.parse(sesionActiva);
      if(confirm(`Ya estÃ¡s logueado como ${s.nombre}. Â¿Continuar con esa sesiÃ³n?`)){
        window.location.href = s.rol==='admin' ? 'admin.html' : 'index.html';
      }else{
        sessionStorage.removeItem('sesionCineMax');
      }
    }

    /* ---------- ValidaciÃ³n y login ---------- */
    form.addEventListener('submit',e=>{
      e.preventDefault();
      form.querySelectorAll('.form-control').forEach(i=>i.classList.remove('is-invalid'));

      const email = emailInp.value.trim();
      const pass  = passInp.value.trim();
      let ok = true;

      if(!email || !email.includes('@')) {emailInp.classList.add('is-invalid'); ok=false;}
      if(!pass)                          {passInp.classList.add('is-invalid');  ok=false;}
      if(!ok) return;

      const usuario = usuarios[email];
      if(!usuario || usuario.password!==pass){
        emailInp.classList.add('is-invalid');
        passInp.classList.add('is-invalid');
        mostrarError('Credenciales incorrectas. Verifica tu email y contraseÃ±a.');
        return;
      }

      // Ã‰xito
      const sesion = {
        email,
        rol:usuario.rol,
        nombre:usuario.nombre,
        perfil:usuario.perfil,
        fechaLogin:new Date().toISOString()
      };
      sessionStorage.setItem('sesionCineMax',JSON.stringify(sesion));
      if(recordar.checked) localStorage.setItem('recordarUsuario',email);
      mostrarSuccess(`Â¡Bienvenido/a ${usuario.nombre}! Redirigiendoâ€¦`);

      setTimeout(()=>{
        window.location.href = usuario.rol==='admin' ? 'admin.html' : 'index.html';
      },1500);
    });

    function mostrarError(msg){
      let box = document.querySelector('.login-error');
      if(!box){
        box = document.createElement('div');
        box.className='alert alert-danger login-error mt-3';
        form.appendChild(box);
      }
      box.textContent = msg;
    }

    function mostrarSuccess(msg){
      const success = document.createElement('div');
      success.className='alert alert-success mt-3';
      success.textContent = msg;
      form.appendChild(success);
    }

    console.log('Sistema de Login CineMax inicializado');
  });

  function cerrarSesion(){
    sessionStorage.removeItem('sesionCineMax');
    localStorage.removeItem('recordarUsuario');
    window.location.href='login.html';
  }
  function obtenerSesion(){
    const s = sessionStorage.getItem('sesionCineMax');
    return s ? JSON.parse(s) : null;
  }
  </script>
</body>
</html>